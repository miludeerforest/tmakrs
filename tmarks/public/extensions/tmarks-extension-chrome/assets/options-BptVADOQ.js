const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-B9vCrEPS.js","assets/prompts-CKcm-rRX.js","assets/index-DGvtTLn_.js"])))=>i.map(i=>d[i]);
import{r as e,j as r,L as a,u as t,E as s,S as i,R as l,a as o}from"./SuccessMessage-CRaW-u6P.js";import{_ as n}from"./preload-helper-BhLMWRjL.js";import{A as d,a as c,T as x,d as u}from"./index-DGvtTLn_.js";import{D as m}from"./prompts-CKcm-rRX.js";function g({formData:a,setFormData:t,handleProviderChange:s,setSuccessMessage:i,handleTestConnection:l,isTesting:o,availableModels:n,isFetchingModels:x,modelFetchError:u,onRefreshModels:g,modelFetchSupported:b,allSavedConnections:p,onApplySavedConnection:h,onDeleteSavedConnection:y,onSaveConnectionPreset:f}){const v=n.length>0,[k,j]=e.useState(!1),[w,N]=e.useState(!1),P=e.useRef(null),C={openai:"OpenAI",claude:"Claude",deepseek:"DeepSeek",zhipu:"æ™ºè°±AI",modelscope:"ModelScope",siliconflow:"SiliconFlow",iflow:"è®¯é£æ˜Ÿç«",custom:"è‡ªå®šä¹‰"};e.useEffect(()=>{if(!k)return;const e=e=>{P.current&&!P.current.contains(e.target)&&j(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[k]),e.useEffect(()=>{v||j(!1)},[v]),e.useEffect(()=>{p.length<=3&&w&&N(!1)},[p.length,w]);return r.jsxs("div",{className:"relative overflow-hidden rounded-2xl border border-gray-200/80 dark:border-gray-700/60 bg-white/90 dark:bg-gray-800/90 shadow-sm backdrop-blur transition-shadow hover:shadow-lg",children:[r.jsx("div",{className:"absolute inset-x-0 top-0 h-1 bg-gradient-to-r from-blue-500 via-indigo-500 to-purple-500"}),r.jsxs("div",{className:"p-8 pt-12 space-y-8",children:[r.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:"AI é…ç½®"}),r.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"è¿æ¥ä½ çš„æ™ºèƒ½æ ‡ç­¾æœåŠ¡ï¼Œç®¡ç†æ¨¡å‹ä¸è°ƒç”¨ç­–ç•¥ã€‚"})]}),r.jsx("button",{type:"button",onClick:f,disabled:!a.apiKey.trim(),className:"inline-flex items-center justify-center rounded-lg px-4 py-2 text-sm font-medium transition-colors "+(a.apiKey.trim()?"bg-blue-600 text-white hover:bg-blue-700 shadow-sm":"bg-gray-200 dark:bg-gray-700 text-gray-400 cursor-not-allowed"),children:"ä¿å­˜å½“å‰é…ç½®"})]}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-sm font-semibold text-gray-800 dark:text-gray-200",children:"å·²ä¿å­˜çš„å…¨éƒ¨é…ç½®"}),r.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400",children:[r.jsxs("span",{children:["å…± ",p.length," ä¸ª"]}),p.length>3&&r.jsx("button",{type:"button",onClick:()=>N(e=>!e),className:"rounded-full border border-gray-300/80 px-2 py-0.5 text-[11px] font-medium text-gray-600 transition-colors hover:bg-gray-100 dark:border-gray-600/70 dark:text-gray-200 dark:hover:bg-gray-700",children:w?"æ”¶èµ·":`å±•å¼€æ›´å¤š (${p.length-3})`})]})]}),0===p.length?r.jsx("div",{className:"rounded-xl border border-dashed border-gray-300/80 dark:border-gray-600/70 bg-gray-50/70 dark:bg-gray-800/40 p-6 text-sm text-gray-500 dark:text-gray-400",children:"ç›®å‰è¿˜æ²¡æœ‰ä¿å­˜è¿‡ä»»ä½•é…ç½®ï¼Œå¡«å†™å¥½ API ä¿¡æ¯åç‚¹å‡»ã€Œä¿å­˜å½“å‰é…ç½®ã€å³å¯åˆ›å»ºé¢„è®¾ã€‚"}):r.jsx("div",{className:"grid gap-3 sm:grid-cols-2 xl:grid-cols-3",children:(w?p:p.slice(0,3)).map((e,t)=>r.jsxs("div",{className:"group flex flex-col justify-between gap-3 rounded-2xl border border-gray-200/80 dark:border-gray-700/60 bg-white/95 dark:bg-gray-900/70 p-4 shadow-sm transition-all hover:-translate-y-1 hover:border-blue-400/60 hover:shadow-lg",children:[r.jsxs("div",{className:"flex items-center justify-between gap-2",children:[r.jsx("p",{className:"text-sm font-semibold text-gray-900 dark:text-gray-100 truncate",title:e.label||e.apiUrl||"æœªå‘½åé…ç½®",children:e.label||"æœªå‘½åé…ç½®"}),r.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-blue-500/10 text-blue-600 dark:text-blue-300 px-2 py-0.5 text-[11px]",children:[r.jsx("span",{className:"h-1.5 w-1.5 rounded-full bg-blue-500/80"}),C[e.provider||a.aiProvider]]})]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("button",{type:"button",onClick:()=>h(e,e.provider),className:"flex-1 rounded-lg bg-blue-600 px-3 py-2 text-xs font-medium text-white transition-colors hover:bg-blue-700",children:"ä½¿ç”¨"}),r.jsx("button",{type:"button",onClick:()=>y(e,e.provider),className:"rounded-lg border border-gray-300/80 dark:border-gray-600/70 px-3 py-2 text-xs font-medium text-gray-600 dark:text-gray-200 transition-colors hover:bg-gray-100 dark:hover:bg-gray-700",children:"åˆ é™¤"})]})]},e.id||`${e.provider||"unknown"}-${e.label||e.apiUrl||"default"}-${t}`))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"AI å¼•æ“"}),r.jsxs("select",{value:a.aiProvider,onChange:e=>s(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"openai",children:"OpenAI (GPT-4, GPT-3.5)"}),r.jsx("option",{value:"claude",children:"Claude (Anthropic)"}),r.jsx("option",{value:"deepseek",children:"DeepSeek"}),r.jsx("option",{value:"zhipu",children:"æ™ºè°±AI (GLM-4)"}),r.jsx("option",{value:"modelscope",children:"ModelScope (é€šä¹‰åƒé—®)"}),r.jsx("option",{value:"siliconflow",children:"SiliconFlow"}),r.jsx("option",{value:"iflow",children:"iFlytek Spark (è®¯é£æ˜Ÿç«)"}),r.jsx("option",{value:"custom",children:"è‡ªå®šä¹‰ API"})]})]}),("custom"===a.aiProvider||"siliconflow"===a.aiProvider||"deepseek"===a.aiProvider||"openai"===a.aiProvider)&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"API åœ°å€"}),r.jsx("input",{type:"url",value:a.apiUrl,onChange:e=>t({...a,apiUrl:e.target.value}),placeholder:"openai"===a.aiProvider?d.OPENAI:"deepseek"===a.aiProvider?d.DEEPSEEK:"siliconflow"===a.aiProvider?d.SILICONFLOW:"è¯·è¾“å…¥è‡ªå®šä¹‰ API åœ°å€",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"API Key"}),r.jsx("input",{type:"password",value:a.apiKey,onChange:e=>t({...a,apiKey:e.target.value}),placeholder:"openai"===a.aiProvider?"è¯·è¾“å…¥ OpenAI API Key":"claude"===a.aiProvider?"è¯·è¾“å…¥ Claude API Key":"deepseek"===a.aiProvider?"è¯·è¾“å…¥ DeepSeek API Key":"zhipu"===a.aiProvider?"è¯·è¾“å…¥æ™ºè°± API Key":"modelscope"===a.aiProvider?"è¯·è¾“å…¥ ModelScope API Key":"siliconflow"===a.aiProvider?"è¯·è¾“å…¥ SiliconFlow API Key":"iflow"===a.aiProvider?"è¯·è¾“å…¥è®¯é£æ˜Ÿç« API Key":"è¯·è¾“å…¥ API Key",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}),r.jsxs("p",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:["openai"===a.aiProvider&&r.jsxs(r.Fragment,{children:["è·å– API Keyï¼š",r.jsx("a",{href:c.OPENAI,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:"OpenAI Platform"})]}),"claude"===a.aiProvider&&r.jsxs(r.Fragment,{children:["è·å– API Keyï¼š",r.jsx("a",{href:c.CLAUDE,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:"Anthropic Console"})]}),"deepseek"===a.aiProvider&&r.jsxs(r.Fragment,{children:["è·å– API Keyï¼š",r.jsx("a",{href:c.DEEPSEEK,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:"DeepSeek Platform"})]}),"zhipu"===a.aiProvider&&r.jsxs(r.Fragment,{children:["è·å– API Keyï¼š",r.jsx("a",{href:c.ZHIPU,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:"æ™ºè°±AIå¼€æ”¾å¹³å°"})]}),"modelscope"===a.aiProvider&&r.jsxs(r.Fragment,{children:["è·å– API Keyï¼š",r.jsx("a",{href:c.MODELSCOPE,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:"ModelScope"})]}),"siliconflow"===a.aiProvider&&r.jsxs(r.Fragment,{children:["è·å– API Keyï¼š",r.jsx("a",{href:c.SILICONFLOW,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:"SiliconFlow"})]}),"iflow"===a.aiProvider&&r.jsxs(r.Fragment,{children:["è·å– API Keyï¼š",r.jsx("a",{href:c.IFLOW,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:"è®¯é£å¼€æ”¾å¹³å°"})]})]})]}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"æ¨¡å‹"}),r.jsx("button",{type:"button",onClick:g,disabled:!b||x||!a.apiKey.trim(),className:"text-xs px-3 py-1 rounded-lg transition-colors "+(b&&!x&&a.apiKey.trim()?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-200 dark:bg-gray-700 text-gray-500 dark:text-gray-400 cursor-not-allowed"),children:x?"è·å–ä¸­...":"åˆ·æ–°æ¨¡å‹"})]}),r.jsxs("div",{className:"relative w-full",ref:P,children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"text",value:a.aiModel,onChange:e=>t({...a,aiModel:e.target.value}),placeholder:"openai"===a.aiProvider?"gpt-4o-mini (æ¨è) æˆ– gpt-4o":"claude"===a.aiProvider?"claude-3-5-sonnet-20241022 (æ¨è)":"deepseek"===a.aiProvider?"deepseek-chat":"zhipu"===a.aiProvider?"glm-4-flash (æ¨è) æˆ– glm-4-plus":"modelscope"===a.aiProvider?"qwen-plus æˆ– qwen-turbo":"siliconflow"===a.aiProvider?"Qwen/Qwen2.5-7B-Instruct":"iflow"===a.aiProvider?"spark-lite æˆ– spark-pro":"è¯·è¾“å…¥æ¨¡å‹åç§°",className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}),v&&r.jsxs("button",{type:"button",onClick:()=>j(e=>!e),className:"px-3 py-2 rounded-lg bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors flex items-center gap-1",children:[r.jsx("span",{className:"text-sm font-medium",children:"é€‰æ‹©æ¨¡å‹"}),r.jsx("span",{className:"transition-transform "+(k?"rotate-180":""),children:"â–¾"})]})]}),v&&k&&r.jsx("div",{className:"absolute z-10 mt-2 right-0 w-full max-h-[33vh] overflow-y-auto rounded-lg border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 shadow-2xl",children:n.map(e=>{const s=a.aiModel===e;return r.jsx("button",{type:"button",onClick:()=>(e=>{t(r=>({...r,aiModel:e})),j(!1)})(e),className:"w-full text-left px-3 py-2 text-sm transition-colors "+(s?"bg-blue-50 dark:bg-blue-900/40 text-blue-600 dark:text-blue-200":"text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700"),children:e},e)})})]}),v&&r.jsxs("p",{className:"mt-2 text-xs text-blue-600 dark:text-blue-400",children:["å·²è·å– ",n.length," ä¸ªæ¨¡å‹ï¼Œå¯ç›´æ¥é€‰æ‹©æˆ–æ‰‹åŠ¨è¾“å…¥ã€‚"]}),u&&r.jsxs("p",{className:"mt-2 text-xs text-red-500 dark:text-red-400",children:["æ¨¡å‹åˆ—è¡¨åŠ è½½å¤±è´¥ï¼š",u]}),!v&&b&&!u&&!x&&r.jsx("p",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:"è¾“å…¥ API åœ°å€ä¸ Key åå¯åˆ·æ–°è·å–å¯ç”¨æ¨¡å‹åˆ—è¡¨ã€‚"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"æœ€å¤§æ¨èæ ‡ç­¾æ•°"}),r.jsx("input",{type:"number",min:"1",max:"10",value:a.maxSuggestedTags,onChange:e=>t({...a,maxSuggestedTags:parseInt(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),r.jsx("div",{children:r.jsx("button",{onClick:l,disabled:o||!a.apiKey,className:"px-4 py-2 bg-green-600 hover:bg-green-700 disabled:bg-gray-400 text-white rounded-lg transition-colors duration-200",children:o?"æµ‹è¯•ä¸­...":"æµ‹è¯•è¿æ¥"})}),r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"è‡ªå®šä¹‰ Prompt"}),r.jsx("button",{onClick:()=>t({...a,enableCustomPrompt:!a.enableCustomPrompt}),className:"px-3 py-1 rounded-lg text-xs font-medium transition-colors "+(a.enableCustomPrompt?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"),children:a.enableCustomPrompt?"å·²å¯ç”¨":"å·²ç¦ç”¨"})]}),a.enableCustomPrompt&&r.jsxs("div",{className:"space-y-3",children:[r.jsx("textarea",{value:a.customPrompt,onChange:e=>t({...a,customPrompt:e.target.value}),rows:10,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono text-xs",placeholder:"è‡ªå®šä¹‰ AI æç¤ºè¯..."}),r.jsxs("div",{className:"p-3 bg-amber-50 dark:bg-amber-900/20 rounded-lg",children:[r.jsx("p",{className:"text-xs font-medium text-amber-600 dark:text-amber-400 mb-1",children:"ğŸ’¡ ä¸“ä¸šç¤ºä¾‹ Promptï¼š"}),r.jsx("pre",{className:"text-xs text-gray-600 dark:text-gray-400 whitespace-pre-wrap max-h-32 overflow-y-auto",children:m}),r.jsxs("div",{className:"mt-2 flex gap-2",children:[r.jsx("button",{onClick:()=>{t({...a,customPrompt:m})},className:"text-xs px-2 py-1 bg-amber-600 hover:bg-amber-700 text-white rounded-md transition-colors duration-200",children:"ä½¿ç”¨æ­¤ç¤ºä¾‹"}),r.jsx("button",{onClick:()=>{navigator.clipboard.writeText(m).then(()=>{i("ç¤ºä¾‹ Prompt å·²å¤åˆ¶åˆ°å‰ªè´´æ¿"),setTimeout(()=>i(null),2e3)})},className:"text-xs px-2 py-1 bg-blue-600 hover:bg-blue-700 text-white rounded-md transition-colors duration-200",children:"å¤åˆ¶ç¤ºä¾‹"}),r.jsxs("button",{onClick:()=>t({...a,enableCustomPrompt:!a.enableCustomPrompt}),className:"text-xs px-2 py-1 bg-gray-600 hover:bg-gray-700 text-white rounded-md transition-colors duration-200",children:[a.enableCustomPrompt?"ç¦ç”¨":"å¯ç”¨","è‡ªå®šä¹‰"]})]})]})]})]})]})]})]})}function b({formData:e,setFormData:a}){return r.jsxs("div",{className:"relative overflow-hidden rounded-2xl border border-sky-200/70 dark:border-sky-500/20 bg-white/90 dark:bg-gray-900/90 shadow-sm backdrop-blur transition-shadow hover:shadow-lg",children:[r.jsx("div",{className:"absolute inset-x-0 top-0 h-1 bg-gradient-to-r from-sky-500 via-cyan-400 to-emerald-400"}),r.jsxs("div",{className:"p-6 pt-10 space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"TMarks API é…ç½®"}),r.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"è®¾ç½®å®˜æ–¹æˆ–è‡ªå»º TMarks æœåŠ¡ç«¯ä»¥åŒæ­¥ä¹¦ç­¾ä¸æ ‡ç­¾æ•°æ®ã€‚"})]}),r.jsx("span",{className:"px-3 py-1 rounded-full bg-sky-500/10 text-xs font-medium text-sky-600 dark:text-sky-300",children:"æ¨èä½¿ç”¨"})]}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"æœåŠ¡å™¨åœ°å€"}),r.jsx("input",{type:"url",value:e.bookmarkApiUrl,onChange:r=>a({...e,bookmarkApiUrl:r.target.value}),placeholder:x.DEFAULT_BASE_URL,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}),r.jsxs("p",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:[r.jsx("span",{className:"font-medium",children:"TMarks å®˜æ–¹åœ°å€ï¼š"}),r.jsx("code",{className:"ml-1 px-1.5 py-0.5 bg-gray-100 dark:bg-gray-700 rounded",children:x.DEFAULT_BASE_URL})]}),r.jsxs("div",{className:"mt-2 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[r.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-2",children:r.jsx("span",{className:"font-semibold text-blue-600 dark:text-blue-400",children:"â„¹ï¸ TMarks è¯´æ˜ï¼š"})}),r.jsxs("ul",{className:"text-xs text-gray-600 dark:text-gray-400 space-y-1",children:[r.jsx("li",{children:"â€¢ TMarks æ˜¯ä¸€ä¸ªæ ‡ç­¾ä¸ºä¸»çš„ä¹¦ç­¾å¯¼èˆª"}),r.jsx("li",{children:"â€¢ æ”¯æŒå¤šè®¾å¤‡åŒæ­¥ã€æ ‡ç­¾ç®¡ç†ã€å…¨æ–‡æœç´¢ç­‰åŠŸèƒ½"}),r.jsx("li",{children:"â€¢ å¡«å†™åŸºç¡€åœ°å€å³å¯ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è¡¥å…¨ /api è·¯å¾„"}),r.jsxs("li",{children:["â€¢ ä¾‹å¦‚ï¼š",r.jsx("code",{className:"px-1 bg-gray-100 dark:bg-gray-700 rounded",children:"https://tmarks.669696.xyz"})]})]})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:"API Key"}),r.jsx("input",{type:"password",value:e.bookmarkApiKey,onChange:r=>a({...e,bookmarkApiKey:r.target.value}),placeholder:"è¯·è¾“å…¥ TMarks API Key",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}),r.jsx("p",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:"åœ¨ TMarks è®¾ç½®ä¸­ç”Ÿæˆ API Key"})]})]})]})]})}function p({formData:e,setFormData:a}){return r.jsxs("div",{className:"relative overflow-hidden rounded-2xl border border-amber-200/70 dark:border-amber-500/20 bg-white/90 dark:bg-gray-900/90 shadow-sm backdrop-blur transition-shadow hover:shadow-lg",children:[r.jsx("div",{className:"absolute inset-x-0 top-0 h-1 bg-gradient-to-r from-amber-400 via-orange-400 to-rose-400"}),r.jsxs("div",{className:"p-6 pt-10 space-y-6",children:[r.jsx("div",{children:r.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"åå¥½è®¾ç½®"})}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"AI æ ‡ç­¾æ¨è"}),r.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"å¯ç”¨åï¼Œä¿å­˜ä¹¦ç­¾æ—¶è‡ªåŠ¨è°ƒç”¨ AI åˆ†æé¡µé¢å¹¶æ¨èæ ‡ç­¾ã€‚"})]}),r.jsx("button",{type:"button",role:"switch","aria-checked":e.enableAI,onClick:()=>a({...e,enableAI:!e.enableAI}),className:"relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 "+(e.enableAI?"bg-blue-600":"bg-gray-200 dark:bg-gray-700"),children:r.jsx("span",{className:"pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out "+(e.enableAI?"translate-x-5":"translate-x-0")})})]}),!e.enableAI&&r.jsx("div",{className:"mt-2 rounded-lg border border-amber-200 bg-amber-50 dark:border-amber-500/30 dark:bg-amber-500/10 px-3 py-2",children:r.jsx("p",{className:"text-xs text-amber-700 dark:text-amber-300",children:"å…³é—­åå°†è·³è¿‡ AI æ¨èï¼Œä½ å¯ä»¥ç›´æ¥ä»æ ‡ç­¾åº“ä¸­é€‰æ‹©æ ‡ç­¾ã€‚"})})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"é»˜è®¤å¯è§æ€§"}),r.jsxs("div",{className:"inline-flex rounded-xl border border-gray-200/80 dark:border-gray-700/70 bg-white/60 dark:bg-gray-800/70 p-1 text-sm font-medium text-gray-600 dark:text-gray-300",children:[r.jsx("button",{type:"button",onClick:()=>a({...e,defaultVisibility:"public"}),className:"rounded-lg px-3 py-1.5 transition-colors "+("public"===e.defaultVisibility?"bg-blue-600 text-white shadow":"hover:text-gray-900 dark:hover:text-white"),children:"å…¬å¼€"}),r.jsx("button",{type:"button",onClick:()=>a({...e,defaultVisibility:"private"}),className:"rounded-lg px-3 py-1.5 transition-colors "+("private"===e.defaultVisibility?"bg-slate-700 text-white shadow":"hover:text-gray-900 dark:hover:text-white"),children:"éšç§"})]}),r.jsx("p",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:"é€‰æ‹©ä¿å­˜ä¹¦ç­¾æ—¶é»˜è®¤ä½¿ç”¨çš„å¯è§æ€§ï¼Œå¯åœ¨ä¿å­˜å‰éšæ—¶åˆ‡æ¢ã€‚"})]}),r.jsx("div",{children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"é»˜è®¤åŒ…å«å°é¢å›¾"}),r.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"å¯ç”¨åï¼Œä¿å­˜ä¹¦ç­¾æ—¶é»˜è®¤åŒ…å«é¡µé¢å°é¢å›¾ã€‚"})]}),r.jsx("button",{type:"button",role:"switch","aria-checked":e.defaultIncludeThumbnail,onClick:()=>a({...e,defaultIncludeThumbnail:!e.defaultIncludeThumbnail}),className:"relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 "+(e.defaultIncludeThumbnail?"bg-blue-600":"bg-gray-200 dark:bg-gray-700"),children:r.jsx("span",{className:"pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out "+(e.defaultIncludeThumbnail?"translate-x-5":"translate-x-0")})})]})}),r.jsx("div",{children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"é»˜è®¤åˆ›å»ºå¿«ç…§"}),r.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"å¯ç”¨åï¼Œä¿å­˜ä¹¦ç­¾æ—¶é»˜è®¤åˆ›å»ºç½‘é¡µå¿«ç…§ã€‚"})]}),r.jsx("button",{type:"button",role:"switch","aria-checked":e.defaultCreateSnapshot,onClick:()=>a({...e,defaultCreateSnapshot:!e.defaultCreateSnapshot}),className:"relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 "+(e.defaultCreateSnapshot?"bg-purple-600":"bg-gray-200 dark:bg-gray-700"),children:r.jsx("span",{className:"pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out "+(e.defaultCreateSnapshot?"translate-x-5":"translate-x-0")})})]})})]})]})]})}function h({stats:e,handleSync:t,isLoading:s,formatDate:i}){return r.jsxs("div",{className:"relative overflow-hidden rounded-2xl border border-emerald-200/70 dark:border-emerald-500/20 bg-white/90 dark:bg-gray-900/90 shadow-sm backdrop-blur transition-shadow hover:shadow-lg",children:[r.jsx("div",{className:"absolute inset-x-0 top-0 h-1 bg-gradient-to-r from-emerald-400 via-teal-400 to-green-500"}),r.jsxs("div",{className:"p-6 pt-10 space-y-6",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"ç¼“å­˜çŠ¶æ€"}),r.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"æŸ¥çœ‹æœ¬åœ°ç¼“å­˜æ¦‚å†µå¹¶æ‰‹åŠ¨è§¦å‘ä¸€æ¬¡åŒæ­¥ã€‚"})]}),r.jsxs("div",{className:"grid gap-4 sm:grid-cols-3",children:[r.jsxs("div",{className:"rounded-xl border border-emerald-200/60 dark:border-emerald-500/30 bg-emerald-50/70 dark:bg-emerald-500/10 p-4 text-center",children:[r.jsx("p",{className:"text-2xl font-bold text-emerald-600 dark:text-emerald-300",children:e.tags}),r.jsx("p",{className:"mt-1 text-xs uppercase tracking-wide text-emerald-700/70 dark:text-emerald-200/70",children:"æ ‡ç­¾æ•°"})]}),r.jsxs("div",{className:"rounded-xl border border-blue-200/60 dark:border-blue-500/30 bg-blue-50/70 dark:bg-blue-500/10 p-4 text-center",children:[r.jsx("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-300",children:e.bookmarks}),r.jsx("p",{className:"mt-1 text-xs uppercase tracking-wide text-blue-700/70 dark:text-blue-200/70",children:"ä¹¦ç­¾æ•°"})]}),r.jsxs("div",{className:"rounded-xl border border-slate-200/60 dark:border-slate-600/40 bg-slate-50/70 dark:bg-slate-600/20 p-4 text-center",children:[r.jsx("p",{className:"text-xs font-medium text-slate-600 dark:text-slate-300",children:i(e.lastSync)}),r.jsx("p",{className:"mt-1 text-xs uppercase tracking-wide text-slate-500 dark:text-slate-400",children:"ä¸Šæ¬¡åŒæ­¥"})]})]}),r.jsx("button",{onClick:t,disabled:s,className:"w-full px-4 py-3 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg font-medium disabled:opacity-60 disabled:cursor-not-allowed flex items-center justify-center gap-2 transition-colors",children:s?r.jsxs(r.Fragment,{children:[r.jsx(a,{}),r.jsx("span",{children:"åŒæ­¥ä¸­..."})]}):"ç«‹å³åŒæ­¥"})]})]})}const y={openai:d.OPENAI,deepseek:d.DEEPSEEK,siliconflow:d.SILICONFLOW},f=new Set(["openai","deepseek","siliconflow","custom"]),v=e=>{const r=e.trim();return r?r.replace(/\s+/g,"").replace(/\/chat\/completions$/,"").replace(/\/$/,""):r},k=(e,r)=>{if(!f.has(e))return!1;if("custom"===e){const e=r?.trim();return Boolean(e&&/^https?:\/\//.test(e))}return!0};async function j(e,r,a){if(!f.has(e))throw new Error("å½“å‰ AI æœåŠ¡æš‚ä¸æ”¯æŒè‡ªåŠ¨è·å–æ¨¡å‹åˆ—è¡¨");if(!r.trim())throw new Error("ç¼ºå°‘ API Key");const t=((e,r)=>{if(r&&r.trim())return v(r);const a=y[e];return a?v(a):void 0})(e,a);if(!t)throw new Error("ç¼ºå°‘ API åœ°å€");return(async(e,r)=>{const a=`${e}/models`,t=await fetch(a,{method:"GET",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}});if(!t.ok){const e=await t.text();throw new Error(`è·å–æ¨¡å‹åˆ—è¡¨å¤±è´¥ (${t.status}): ${e||t.statusText}`)}const s=await t.json();if(!Array.isArray(s?.data))throw new Error("æ¨¡å‹åˆ—è¡¨å“åº”æ ¼å¼æ— æ•ˆ");const i=s.data.map(e=>{if(e&&"object"==typeof e&&"id"in e)return e.id}).filter(e=>"string"==typeof e&&e.length>0);if(0===i.length)throw new Error("æ¨¡å‹åˆ—è¡¨ä¸ºç©º");return i})(t,r)}function w(){const{config:a,loadConfig:l,saveConfig:o,syncCache:d,error:c,successMessage:x,isLoading:y,setError:f,setSuccessMessage:v}=t(),[w,N]=e.useState({aiProvider:"openai",apiKey:"",apiUrl:"",aiModel:"",bookmarkApiUrl:"",bookmarkApiKey:"",enableCustomPrompt:!1,customPrompt:m,maxSuggestedTags:5,defaultVisibility:"public",enableAI:!0,defaultIncludeThumbnail:!0,defaultCreateSnapshot:!1}),[P,C]=e.useState({tags:0,bookmarks:0,lastSync:0}),[A,I]=e.useState(!1),[S,K]=e.useState([]),[E,T]=e.useState(!1),[U,M]=e.useState(null),[D,F]=e.useState(0),L=e.useRef(null),[$,O]=e.useState({}),[_,V]=e.useState(!1),[z,R]=e.useState(""),[B,G]=e.useState(!1),[W,q]=e.useState(null),Q=()=>`${Date.now()}-${Math.random().toString(16).slice(2,10)}`,H=()=>{B||(V(!1),q(null))};e.useEffect(()=>{(async()=>{await l();const e=await u.getStats();C(e)})()},[]),e.useEffect(()=>{if(a){const e=a.aiConfig.provider,r=a.aiConfig.apiKeys[e]||"",t=a.aiConfig.apiUrls?.[e]||"";N({aiProvider:e,apiKey:r,apiUrl:t,aiModel:a.aiConfig.model||"",bookmarkApiUrl:a.bookmarkSite.apiUrl,bookmarkApiKey:a.bookmarkSite.apiKey,enableCustomPrompt:a.aiConfig.enableCustomPrompt||!1,customPrompt:a.aiConfig.customPrompt||w.customPrompt,maxSuggestedTags:a.preferences.maxSuggestedTags,defaultVisibility:a.preferences.defaultVisibility,enableAI:a.preferences.enableAI??!0,defaultIncludeThumbnail:a.preferences.defaultIncludeThumbnail??!0,defaultCreateSnapshot:a.preferences.defaultCreateSnapshot??!1});const s=(e=>{const r={};return e?(Object.keys(e).forEach(a=>{const t=e[a]||[];r[a]=Array.isArray(t)?t.slice(0,10).map(e=>({...e,provider:e.provider||a,id:e.id||Q()})):[]}),r):r})(a.aiConfig.savedConnections);O(s)}},[a]);e.useEffect(()=>{const e=k(w.aiProvider,w.apiUrl),r=w.apiKey.trim();if(!e||!r)return K([]),M(null),T(!1),void(L.current=null);const a=`${w.aiProvider}|${(w.apiUrl||"").trim()}|${r}|${D}`;if(L.current===a)return;let t=!1;return(async()=>{T(!0),M(null);try{const e=await j(w.aiProvider,r,w.apiUrl);if(t)return;K(e),T(!1),M(null),L.current=a,N(r=>r.aiModel?r:{...r,aiModel:e[0]||""})}catch(e){if(t)return;K([]),M(e instanceof Error?e.message:String(e)),T(!1),L.current=a}})(),()=>{t=!0}},[w.aiProvider,w.apiUrl,w.apiKey,D]);const Z=e.useMemo(()=>Object.entries($).flatMap(([e,r])=>(r||[]).map(r=>({...r,provider:r.provider||e}))),[$]),J=k(w.aiProvider,w.apiUrl);return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"min-h-screen w-screen bg-gradient-to-br from-gray-100 via-white to-gray-100 dark:from-gray-950 dark:via-gray-900 dark:to-gray-950",children:r.jsxs("div",{className:"max-w-6xl mx-auto px-6 py-12",children:[r.jsxs("div",{className:"relative overflow-hidden rounded-3xl border border-gray-200/70 dark:border-gray-800/60 bg-white/90 dark:bg-gray-900/90 shadow-sm backdrop-blur mb-10",children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-500/15 via-indigo-500/10 to-purple-500/20 dark:from-blue-500/25 dark:via-indigo-500/20 dark:to-purple-500/25"}),r.jsxs("div",{className:"relative p-10",children:[r.jsx("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-blue-500/10 text-sm font-medium text-blue-600 dark:text-blue-300",children:"è®¾ç½®ä¸­å¿ƒ"}),r.jsx("h1",{className:"mt-4 text-4xl font-bold text-gray-900 dark:text-white tracking-tight",children:"ä¸ªæ€§åŒ–ä½ çš„ä¹¦ç­¾åŠ©ç†"}),r.jsx("p",{className:"mt-3 max-w-2xl text-base text-gray-600 dark:text-gray-300",children:"ç®¡ç† AI æ¥å…¥ã€åŒæ­¥ç­–ç•¥ä¸æœåŠ¡ç«¯é…ç½®ï¼Œä¸ºä½ çš„å·¥ä½œæµæ‰“é€ é¡ºæ»‘çš„çŸ¥è¯†æ”¶é›†ä½“éªŒã€‚"}),r.jsxs("div",{className:"mt-6 flex flex-wrap gap-3 text-xs font-medium text-gray-500 dark:text-gray-400",children:[r.jsx("span",{className:"px-3 py-1 rounded-full bg-white/70 dark:bg-white/10 border border-white/80 dark:border-white/20",children:"AI æ ‡ç­¾"}),r.jsx("span",{className:"px-3 py-1 rounded-full bg-white/70 dark:bg-white/10 border border-white/80 dark:border-white/20",children:"å¤šç«¯åŒæ­¥"}),r.jsx("span",{className:"px-3 py-1 rounded-full bg-white/70 dark:bg-white/10 border border-white/80 dark:border-white/20",children:"å®‰å…¨é…ç½®"})]})]})]}),r.jsxs("div",{className:"mb-10 space-y-4",children:[c&&r.jsx(s,{message:c,onDismiss:()=>f(null)}),x&&r.jsx(i,{message:x})]}),r.jsxs("div",{className:"grid gap-8 lg:grid-cols-12",children:[r.jsx("div",{className:"lg:col-span-8 space-y-8",children:r.jsx(g,{formData:w,setFormData:N,handleProviderChange:e=>{const r=a?.aiConfig.apiKeys[e]||"",t=a?.aiConfig.apiUrls?.[e]||"";N({...w,aiProvider:e,apiKey:r,apiUrl:t}),K([]),M(null),L.current=null},setSuccessMessage:v,handleTestConnection:async()=>{try{I(!0),f(null);const{getAIProvider:e}=await n(async()=>{const{getAIProvider:e}=await import("./index-B9vCrEPS.js").then(e=>e.i);return{getAIProvider:e}},__vite__mapDeps([0,1,2])),r=e(w.aiProvider),a={page:{title:"Claude Code - AI ç¼–ç¨‹åŠ©æ‰‹",url:"https://claude.ai",description:"Claude æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ AI ç¼–ç¨‹åŠ©æ‰‹",content:"Claude Code æ˜¯ Anthropic æ¨å‡ºçš„æ™ºèƒ½ç¼–ç¨‹å·¥å…·ï¼Œæ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€å’Œæ¡†æ¶ã€‚"},context:{existingTags:["å¼€å‘å·¥å…·","AI","ç¼–ç¨‹","æ•ˆç‡"],recentBookmarks:[]},options:{maxTags:3,preferExisting:!0}},t=await r.generateTags(a,w.apiKey,w.aiModel||void 0,w.apiUrl||void 0,w.enableCustomPrompt?w.customPrompt:void 0);v(`API æµ‹è¯•æˆåŠŸï¼è¿”å› ${t.suggestedTags.length} ä¸ªæ ‡ç­¾ï¼š${t.suggestedTags.map(e=>e.name).join(", ")}`),setTimeout(()=>v(null),5e3)}catch(e){f(e instanceof Error?e.message:"API æµ‹è¯•å¤±è´¥")}finally{I(!1)}},isTesting:A,availableModels:S,isFetchingModels:E,modelFetchError:U,onRefreshModels:()=>{k(w.aiProvider,w.apiUrl)&&w.apiKey.trim()&&(L.current=null,F(e=>e+1))},modelFetchSupported:J,allSavedConnections:Z,onApplySavedConnection:(e,r)=>{const a=r||e.provider||w.aiProvider;N(r=>({...r,aiProvider:a,apiUrl:e.apiUrl||"",apiKey:e.apiKey||"",aiModel:e.model||""})),a!==w.aiProvider&&(K([]),M(null),L.current=null)},onDeleteSavedConnection:async(e,r)=>{const t=r||e.provider||w.aiProvider;if(!t)return void f("æ— æ³•ç¡®å®šé…ç½®æ‰€å±çš„ AI å¼•æ“");const s=$,i=((e,r,a)=>{const t=e[r]||[],s=(a.apiUrl||"").trim(),i=(a.apiKey||"").trim(),l=(a.model||"").trim(),o=t.filter(e=>a.id&&e.id?e.id!==a.id:(e.apiUrl||"").trim()!==s||(e.apiKey||"").trim()!==i||(e.model||"").trim()!==l),n={...e};return o.length>0?n[r]=o:delete n[r],n})(s,t,e);O(i);try{if(!a)throw new Error("é…ç½®å°šæœªåŠ è½½");await o({aiConfig:{...a.aiConfig,savedConnections:i}}),v("å·²åˆ é™¤ä¿å­˜çš„è¿æ¥"),setTimeout(()=>v(null),2e3)}catch(l){O(s),f(l instanceof Error?l.message:"åˆ é™¤è¿æ¥å¤±è´¥")}},onSaveConnectionPreset:()=>{if(!w.apiKey.trim())return void f("è¯·å…ˆå¡«å†™ API Key å†ä¿å­˜é…ç½®");const e=`é…ç½® ${($[w.aiProvider]?.length||0)+1}`;R(e),q(null),V(!0)}})}),r.jsxs("div",{className:"lg:col-span-4 space-y-8",children:[r.jsxs("div",{className:"relative overflow-hidden rounded-2xl border border-gray-200/80 dark:border-gray-800/60 bg-white/90 dark:bg-gray-900/90 shadow-sm backdrop-blur transition-shadow hover:shadow-lg",children:[r.jsx("div",{className:"absolute inset-x-0 top-0 h-1 bg-gradient-to-r from-slate-500 via-gray-500 to-gray-700"}),r.jsxs("div",{className:"p-6 pt-10 space-y-6",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"ä¿å­˜ä¸åŒæ­¥"}),r.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"ä¿å­˜å½“å‰é…ç½®æˆ–å¿«é€Ÿé‡ç½®ä¸ºé»˜è®¤çŠ¶æ€ã€‚"})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[r.jsx("button",{onClick:()=>{confirm("ç¡®å®šè¦é‡ç½®æ‰€æœ‰è®¾ç½®å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚")&&(N({aiProvider:"openai",apiKey:"",apiUrl:"",aiModel:"",bookmarkApiUrl:"",bookmarkApiKey:"",enableCustomPrompt:!1,customPrompt:m,maxSuggestedTags:5,defaultVisibility:"public",enableAI:!0,defaultIncludeThumbnail:!0,defaultCreateSnapshot:!1}),v("è®¾ç½®å·²é‡ç½®"),setTimeout(()=>v(null),2e3))},className:"flex-1 rounded-lg border border-gray-300/80 dark:border-gray-600/70 px-4 py-3 text-sm font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:"é‡ç½®è®¾ç½®"}),r.jsx("button",{onClick:async()=>{try{await o({aiConfig:{provider:w.aiProvider,apiKeys:{...a?.aiConfig.apiKeys,[w.aiProvider]:w.apiKey},apiUrls:{...a?.aiConfig.apiUrls,[w.aiProvider]:w.apiUrl},model:w.aiModel,enableCustomPrompt:w.enableCustomPrompt,customPrompt:w.customPrompt,savedConnections:$},bookmarkSite:{apiUrl:w.bookmarkApiUrl,apiKey:w.bookmarkApiKey},preferences:{theme:a?.preferences.theme||"auto",autoSync:a?.preferences.autoSync??!0,syncInterval:a?.preferences.syncInterval??24,maxSuggestedTags:w.maxSuggestedTags,defaultVisibility:w.defaultVisibility,enableAI:w.enableAI,defaultIncludeThumbnail:w.defaultIncludeThumbnail,defaultCreateSnapshot:w.defaultCreateSnapshot}}),v("è®¾ç½®å·²ä¿å­˜!"),setTimeout(()=>v(null),2e3)}catch(e){f(e instanceof Error?e.message:"ä¿å­˜å¤±è´¥")}},disabled:y,className:"flex-1 rounded-lg bg-blue-600 px-4 py-3 text-sm font-medium text-white shadow-sm hover:bg-blue-700 disabled:cursor-not-allowed disabled:opacity-60 transition-colors",children:y?"ä¿å­˜ä¸­...":"ä¿å­˜è®¾ç½®"})]})]})]}),r.jsx(p,{formData:w,setFormData:N}),r.jsx(b,{formData:w,setFormData:N}),r.jsx(h,{stats:P,handleSync:async()=>{try{await d();const e=await u.getStats();C(e)}catch(e){f(e instanceof Error?e.message:"åŒæ­¥å¤±è´¥")}},isLoading:y,formatDate:e=>e?new Date(e).toLocaleString("zh-CN"):"ä»æœªåŒæ­¥"})]})]})]})}),_&&r.jsx("div",{className:"fixed inset-0 z-40 flex items-center justify-center bg-black/40 backdrop-blur-sm px-4",children:r.jsxs("div",{className:"relative w-full max-w-md overflow-hidden rounded-2xl border border-blue-500/20 bg-white/95 dark:bg-gray-900/95 shadow-xl",children:[r.jsx("div",{className:"absolute inset-x-0 top-0 h-1 bg-gradient-to-r from-blue-500 via-indigo-500 to-purple-500"}),r.jsxs("div",{className:"p-6 pt-10 space-y-6",children:[r.jsxs("div",{className:"flex items-start justify-between gap-4",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"ä¿å­˜å½“å‰é…ç½®"}),r.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:"ä¸ºå½“å‰ AI è®¾ç½®è¾“å…¥ä¸€ä¸ªæ˜“è®°çš„åç§°ã€‚"})]}),r.jsx("button",{type:"button",onClick:H,className:"rounded-full border border-transparent px-3 py-1 text-xl leading-none text-gray-400 transition-colors hover:border-gray-200 hover:text-gray-600 dark:hover:border-gray-700 dark:hover:text-gray-300","aria-label":"å…³é—­",children:"Ã—"})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"é…ç½®åç§°"}),r.jsx("input",{type:"text",value:z,onChange:e=>R(e.target.value),autoFocus:!0,className:"w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 px-3 py-2 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"ä¾‹å¦‚ï¼šç”Ÿäº§ç¯å¢ƒé…ç½®"})]}),W&&r.jsx("div",{className:"rounded-lg border border-red-300/70 bg-red-50/80 px-3 py-2 text-sm text-red-600 dark:border-red-500/40 dark:bg-red-500/10 dark:text-red-300",children:W}),r.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[r.jsx("button",{type:"button",onClick:H,disabled:B,className:"rounded-lg border border-gray-300/80 dark:border-gray-600/70 px-4 py-2 text-sm font-medium text-gray-600 dark:text-gray-200 transition-colors hover:bg-gray-100 dark:hover:bg-gray-800 disabled:cursor-not-allowed disabled:opacity-60",children:"å–æ¶ˆ"}),r.jsx("button",{type:"button",onClick:async()=>{const e=w.apiKey.trim();if(!e)return void q("è¯·å…ˆå¡«å†™ API Key å†ä¿å­˜é…ç½®");const r=z.trim();if(!r)return void q("é…ç½®åç§°ä¸èƒ½ä¸ºç©º");if(!a)return f("é…ç½®å°šæœªåŠ è½½ï¼Œç¨åå†è¯•"),void V(!1);G(!0),q(null);const t={apiUrl:w.apiUrl,apiKey:e,model:w.aiModel,label:r,provider:w.aiProvider},s=$,i=((e,r,a)=>{const t=e[r]||[],s=(a.apiUrl||"").trim(),i=(a.apiKey||"").trim(),l=(a.model||"").trim(),o={...a,apiUrl:s||void 0,apiKey:i||void 0,model:l||void 0,provider:r,label:a.label?.trim()||a.label,lastUsedAt:Date.now(),id:a.id||Q()},n=Boolean(a.id),d=n?t.findIndex(e=>e.id&&e.id===a.id):-1;let c;return n&&d>=0?(c=[...t],c[d]=o):c=[o,...t].slice(0,10),{...e,[r]:c}})(s,w.aiProvider,t);O(i);try{await o({aiConfig:{...a.aiConfig,savedConnections:i}}),v(`å·²ä¿å­˜ä¸ºã€Œ${r}ã€`),setTimeout(()=>v(null),2e3),V(!1)}catch(l){O(s),q(l instanceof Error?l.message:"ä¿å­˜é…ç½®å¤±è´¥")}finally{G(!1)}},disabled:B,className:"rounded-lg bg-blue-600 px-4 py-2 text-sm font-medium text-white shadow-sm transition-colors hover:bg-blue-700 disabled:cursor-not-allowed disabled:opacity-60",children:B?"ä¿å­˜ä¸­...":"ç¡®è®¤ä¿å­˜"})]})]})]})})]})}const N=document.getElementById("root");N&&l.createRoot(N).render(r.jsx(o.StrictMode,{children:r.jsx(w,{})}));
